<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Olimpollo - Gesti√≥n de Men√∫</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* ==========================================================================
           BASE DE ESTILOS UNIFICADA PARA OLIMPOLLO
           ========================================================================== */
        :root{--bg-main:#ECF0F1;--bg-header:#FFFFFF;--card-bg:#FFFFFF;--primary-text:#502c2c;--secondary-text:#808B96;--accent-color:#db3434;--accent-hover:#b92929;--border-color:#D5D8DC;--shadow-light:0 4px 15px rgba(0, 0, 0, 0.08);--shadow-heavy:0 10px 20px rgba(0, 0, 0, 0.12);}body{margin:0;font-family:'Poppins', sans-serif;background-color:var(--bg-main);color:var(--primary-text);display:flex;flex-direction:column;min-height:100vh;}header{background:var(--bg-header);padding:15px 40px;box-shadow:0 2px 10px rgba(0, 0, 0, 0.05);display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border-color);}header .logo{font-size:24px;font-weight:600;text-decoration:none;color:var(--primary-text);}header nav{display:flex;gap:20px;}header nav a{text-decoration:none;color:var(--secondary-text);font-weight:500;transition:color 0.3s;}header nav a:hover{color:var(--accent-color);}.user-info{display:flex;align-items:center;gap:20px;}#user-identifier{font-weight:500;background-color:var(--bg-main);padding:5px 12px;border-radius:15px;font-size:14px;}.logout{background:var(--accent-color);color:white;border:none;padding:8px 18px;border-radius:20px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color 0.3s;}.logout:hover{background-color:var(--accent-hover);}main{flex:1;padding:40px;max-width:1400px;margin:0 auto;width:100%;box-sizing:border-box;}h1, h2, h3{margin-top:0;}h2.page-title{margin-bottom:30px;font-size:28px;font-weight:600;}.card{background:var(--card-bg);border-radius:12px;padding:25px;box-shadow:var(--shadow-light);margin-bottom:25px;}table{width:100%;border-collapse:collapse;background:var(--card-bg);border-radius:12px;overflow:hidden;box-shadow:var(--shadow-light);}th, td{padding:15px;text-align:left;border-bottom:1px solid var(--bg-main);}th{font-weight:600;font-size:14px;text-transform:uppercase;color:var(--secondary-text);background-color:#F8F9F9;}tr:hover{background-color:#FDF2F2;}.btn{border:none;padding:10px 20px;border-radius:8px;cursor:pointer;font-weight:500;font-family:'Poppins', sans-serif;transition:background-color 0.3s, transform 0.2s;}.btn:hover{transform:translateY(-2px);}.btn-primary{background-color:var(--accent-color);color:white;}.btn-primary:hover{background-color:var(--accent-hover);}.btn-secondary{background-color:var(--secondary-text);color:white;}.btn-secondary:hover{background-color:#6C7A89;}.btn-danger{background-color:#E74C3C;color:white;}.btn-success{background-color:#2ECC71;color:white;}label{display:block;margin-bottom:8px;font-weight:500;font-size:14px;}input[type="text"],input[type="password"],input[type="number"],input[type="date"],select,textarea{width:100%;padding:12px;border:1px solid var(--border-color);border-radius:8px;font-family:'Poppins', sans-serif;font-size:14px;box-sizing:border-box;transition:border-color 0.3s, box-shadow 0.3s;}input:focus, select:focus, textarea:focus{outline:none;border-color:var(--accent-color);box-shadow:0 0 0 3px rgba(219, 52, 52, 0.1);}.modal{display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);justify-content:center;align-items:center;overflow-y:auto;padding:20px 0;}.modal-content{background:var(--card-bg);padding:30px;border-radius:12px;box-shadow:var(--shadow-heavy);width:90%;max-width:500px;position:relative;margin:auto;}.close{position:absolute;top:15px;right:20px;font-size:28px;cursor:pointer;color:var(--secondary-text);}footer{text-align:center;padding:20px;font-size:14px;color:var(--secondary-text);}
        /* Estilos espec√≠ficos para esta p√°gina */
        .action-bar { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 25px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-grid-full { grid-column: 1 / -1; }
        .option-list { list-style: none; padding: 0; margin: 15px 0; max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px; }
        .option-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; }
        .option-item:not(:last-child) { border-bottom: 1px solid var(--bg-main); }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="logo">Olimpollo</a>
        <nav>
            <a href="pedidos.html">POS</a>
            <a href="pedidos_lista.html">Pedidos</a>
            <a href="inventario.html">Inventario</a>
            <a href="reportes.html">Reportes</a>
        </nav>
        <div class="user-info">
            <span id="user-identifier"></span>
            <button class="logout" id="btn-logout">Cerrar Sesi√≥n</button>
        </div>
    </header>

    <main>
        <h2 class="page-title">Gesti√≥n de Men√∫</h2>
        <div class="action-bar">
            <button id="btn-agregar-producto" class="btn btn-primary">‚ûï Agregar Nuevo Producto</button>
            <button id="btn-gestionar-opciones" class="btn btn-secondary">‚öôÔ∏è Gestionar Modificadores</button>
        </div>

        <table>
            <thead>
                <tr>
                    <th>ID</th><th>Producto</th><th>Categor√≠a</th><th>Precio</th><th>Receta ID</th><th>Acciones</th>
                </tr>
            </thead>
            <tbody id="tabla-productos-body">
                <tr><td colspan="6">Cargando productos...</td></tr>
            </tbody>
        </table>
    </main>

    <div id="modalProducto" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3 id="modal-titulo">Agregar Producto</h3>
            <form id="form-producto" style="margin-top: 20px;">
                <input type="hidden" id="producto-id">
                <div class="form-grid">
                    <div>
                        <label for="nombre-venta">Nombre del Producto:</label>
                        <input type="text" id="nombre-venta" required>
                    </div>
                    <div>
                        <label for="precio-base">Precio Base:</label>
                        <input type="number" id="precio-base" min="0" step="0.01" required>
                    </div>
                    <div class="form-grid-full">
                        <label for="categoria">Categor√≠a:</label>
                        <select id="categoria" required>
                            <option value="Platos Fuertes">Platos Fuertes</option>
                            <option value="Sides">Sides</option>
                            <option value="Bebidas">Bebidas</option>
                            <option value="Promos">Promos</option>
                            <option value="Aderezos">Aderezos</option>
                        </select>
                    </div>
<div class="form-grid-full">
    <label>Grupos de Modificadores:</label>
    <div id="container-checks-grupos" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 10px; border: 1px solid var(--border-color); padding: 15px; border-radius: 8px; max-height: 150px; overflow-y: auto; background: #F8F9F9;">
        <span style="color: gray; font-size: 13px;">Cargando grupos...</span>
    </div>
    <small style="color: var(--secondary-text); font-size: 12px;">Selecciona los grupos que aplica este producto.</small>
</div>
                    <div class="form-grid-full">
                        <label for="descripcion">Descripci√≥n:</label>
                        <textarea id="descripcion" rows="2"></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">Guardar Producto</button>
            </form>
        </div>
    </div>

    <div id="modalOpciones" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Gestionar Modificadores</h3>
            <div style="margin-top: 20px;">
<label>Seleccionar Grupo:</label>
<div style="display: flex; gap: 10px; align-items: center; margin-bottom: 20px;">
    <select id="mod-grupo-select">
        </select>

    <input type="text" id="mod-grupo-input" placeholder="Nombre del nuevo grupo" style="display: none; flex: 1;">

    <button id="btn-toggle-grupo" class="btn btn-secondary" title="Crear Nuevo Grupo" style="padding: 10px 15px;">
        +
    </button>

    <button id="btn-delete-grupo" class="btn btn-danger" title="Eliminar Grupo Actual" style="padding: 10px 15px;">
        üóëÔ∏è
    </button>
</div>
            <div style="margin-top: 20px;">
                <h4>Valores para "<strong id="nombre-grupo-actual">Salsa</strong>"</h4>
                <ul id="lista-opciones-valores" class="option-list"></ul>
            </div>
            <hr style="border: 1px solid var(--bg-main); margin: 20px 0;">
            <form id="form-agregar-opcion">
                <h4>Agregar a "<span id="nombre-grupo-form">Salsa</span>"</h4>
                <div class="form-grid">
                    <div>
                        <label for="valor-opcion">Valor (Ej: BBQ Picante):</label>
                        <input type="text" id="valor-opcion" required>
                    </div>
                    <div>
                        <label for="precio-adicional">Precio Adicional ($):</label>
                        <input type="number" id="precio-adicional" value="0.00" step="0.01" min="0" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-secondary" style="width: 100%; margin-top: 20px;">A√±adir Valor</button>
            </form>
        </div>
    </div>
    
    <footer>&copy; 2025 Los Boneless del Olimpo</footer>

<script>
    // Funci√≥n para decodificar JWT
    function parseJwt(token) {
        try {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
            return JSON.parse(jsonPayload);
        } catch (e) {
            return null;
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. CONFIGURACI√ìN ---
        const token = localStorage.getItem('authToken');
        const role = localStorage.getItem('userRole');
        
        // Verificaci√≥n de seguridad b√°sica
        if (!token || role !== 'Administrador') {
            alert('Acceso denegado. Solo Administradores.');
            window.location.href = 'index.html';
            return;
        }

        const userData = parseJwt(token);
        if (userData && userData.username) {
            document.getElementById('user-identifier').textContent = userData.username;
        }
        document.getElementById('btn-logout').addEventListener('click', () => {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userRole');
            window.location.href = 'login.html';
        });

        const API_MENU_PRODUCTOS_URL = 'https://olimpollo-api.onrender.com/api/menu/productos';
        const API_MENU_OPCIONES_URL = 'https://olimpollo-api.onrender.com/api/menu/opciones';
        const API_MENU_POS_URL = 'https://olimpollo-api.onrender.com/api/menu/pos';

        // --- 2. ELEMENTOS DOM ---
        const tablaBody = document.getElementById('tabla-productos-body');
        const modalProducto = document.getElementById('modalProducto');
        const modalOpciones = document.getElementById('modalOpciones');
        const listaOpcionesValores = document.getElementById('lista-opciones-valores');
        const containerChecksGrupos = document.getElementById('container-checks-grupos'); // NUEVO CONTAINER

        const formProducto = document.getElementById('form-producto');
        const formAgregarOpcion = document.getElementById('form-agregar-opcion');
        
        // Elementos de Modificadores
        const selectGrupoMod = document.getElementById('mod-grupo-select');
        const inputGrupoNew = document.getElementById('mod-grupo-input');
        const btnToggleGroup = document.getElementById('btn-toggle-grupo');
        const btnDeleteGroup = document.getElementById('btn-delete-grupo');
        const nombreGrupoActual = document.getElementById('nombre-grupo-actual');
        const nombreGrupoForm = document.getElementById('nombre-grupo-form');
        
        // Elementos Formulario Producto
        const productoIdInput = document.getElementById('producto-id');
        const nombreVentaInput = document.getElementById('nombre-venta');
        const precioBaseInput = document.getElementById('precio-base');
        const categoriaSelect = document.getElementById('categoria');
        const descripcionTextarea = document.getElementById('descripcion');

        // Estado
        let opcionesData = []; 
        let productosData = [];     
        let modoNuevoGrupo = false;

        // --- 3. FUNCIONES AUXILIARES ---
        const abrirModal = (modal) => modal.style.display = 'flex';
        const cerrarModales = () => { modalProducto.style.display = 'none'; modalOpciones.style.display = 'none'; };

        // --- NUEVA FUNCI√ìN: RENDERIZAR CHECKBOXES DE GRUPOS ---
        const renderizarChecksGrupos = async (seleccionadosStr = "") => {
            containerChecksGrupos.innerHTML = '<span style="color:gray">Cargando...</span>';
            
            try {
                // 1. Convertir string "Salsa,Aderezo" a array ['Salsa', 'Aderezo']
                const seleccionados = seleccionadosStr ? seleccionadosStr.split(',').map(s => s.trim()) : [];
                
                // 2. Obtener grupos disponibles desde la API
                const response = await fetch(API_MENU_POS_URL);
                const data = await response.json();
                const gruposDisponibles = Object.keys(data.opciones || {}); // ["Salsa", "Aderezo", "Papas"]

                containerChecksGrupos.innerHTML = ''; // Limpiar

                if (gruposDisponibles.length === 0) {
                    containerChecksGrupos.innerHTML = '<span style="font-size:12px">No hay grupos creados. Ve a "Gestionar Modificadores" primero.</span>';
                    return;
                }

                // 3. Crear un checkbox por cada grupo
                gruposDisponibles.forEach(grupo => {
                    const label = document.createElement('label');
                    label.style.display = 'flex';
                    label.style.alignItems = 'center';
                    label.style.gap = '8px';
                    label.style.cursor = 'pointer';
                    label.style.fontSize = '14px';

                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.value = grupo;
                    checkbox.name = 'grupos_check';
                    
                    // Si el producto ya ten√≠a este grupo, marcarlo
                    if (seleccionados.includes(grupo)) {
                        checkbox.checked = true;
                    }

                    label.appendChild(checkbox);
                    label.appendChild(document.createTextNode(grupo));
                    containerChecksGrupos.appendChild(label);
                });

            } catch (error) {
                console.error("Error cargando grupos para checks:", error);
                containerChecksGrupos.innerHTML = '<span style="color:red">Error al cargar grupos.</span>';
            }
        };

        // --- FUNCIONES DE CARGA DE DATOS ---
        const cargarGruposModificadores = async () => {
            try {
                const response = await fetch(API_MENU_POS_URL);
                const data = await response.json();
                const grupos = Object.keys(data.opciones);
                
                selectGrupoMod.innerHTML = '';
                if (grupos.length > 0) {
                    grupos.forEach(grupo => {
                        const option = document.createElement('option');
                        option.value = grupo;
                        option.textContent = grupo;
                        selectGrupoMod.appendChild(option);
                    });
                    fetchOpcionesPorGrupo(selectGrupoMod.value);
                } else {
                    const option = document.createElement('option');
                    option.textContent = "Sin grupos creados";
                    selectGrupoMod.appendChild(option);
                }
            } catch (error) { console.error(error); }
        };

        const renderOpcionesValores = () => {
            listaOpcionesValores.innerHTML = '';
            if (modoNuevoGrupo) {
                 listaOpcionesValores.innerHTML = '<li class="option-item" style="color:gray;">A√±ade un valor abajo para crear este nuevo grupo.</li>';
                 return;
            }
            if (opcionesData.length === 0) {
                listaOpcionesValores.innerHTML = '<li class="option-item">No hay valores.</li>';
            } else {
                opcionesData.forEach(opcion => {
                    const li = document.createElement('li');
                    li.className = 'option-item';
                    li.innerHTML = `<span>${opcion.valor} ($${parseFloat(opcion.precio_adicional).toFixed(2)})</span> <button class="btn btn-danger btn-eliminar-opcion" data-id="${opcion.id}" style="padding: 3px 8px;">X</button>`;
                    listaOpcionesValores.appendChild(li);
                });
            }
        };

        const renderProductos = (productos) => {
            productosData = productos; 
            tablaBody.innerHTML = '';
            productos.forEach(p => {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${p.id}</td><td>${p.nombre_venta}</td><td>${p.categoria}</td><td>$${parseFloat(p.precio_base).toFixed(2)}</td><td>${p.receta_id || "-"}</td><td><button class="btn btn-secondary btn-editar-producto" data-id="${p.id}">Editar</button> <button class="btn btn-danger btn-eliminar-producto" data-id="${p.id}">Eliminar</button></td>`;
                tablaBody.appendChild(tr);
            });
        };

        const fetchProductos = async () => {
            try {
                const response = await fetch(API_MENU_PRODUCTOS_URL);
                if (!response.ok) throw new Error("Error");
                const productos = await response.json();
                renderProductos(productos);
            } catch (error) {
                tablaBody.innerHTML = `<tr><td colspan="6" style="color:red;">Error cargando men√∫.</td></tr>`;
            }
        };

        const fetchOpcionesPorGrupo = async (grupo) => {
            if (!grupo || modoNuevoGrupo) return;
            nombreGrupoActual.textContent = grupo;
            nombreGrupoForm.textContent = grupo;
            try {
                const response = await fetch(API_MENU_OPCIONES_URL + `?nombre_opcion=${encodeURIComponent(grupo)}`);
                opcionesData = await response.json();
                renderOpcionesValores();
            } catch (error) { console.error(error); }
        };

        // --- GUARDADO DE PRODUCTOS ---
        const guardarProducto = async (data, isEdit) => {
            try {
                const url = isEdit ? `${API_MENU_PRODUCTOS_URL}/${data.id}` : API_MENU_PRODUCTOS_URL;
                const method = isEdit ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method: method,
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error("Error al guardar.");
                cerrarModales();
                fetchProductos();
                alert(`Producto ${isEdit ? "actualizado" : "agregado"} con √©xito.`);
            } catch (error) {
                alert("Error: " + error.message);
            }
        };

        // --- MANEJADORES DE EVENTOS ---
        
        // Bot√≥n "Agregar Nuevo Producto"
        document.getElementById('btn-agregar-producto').addEventListener('click', () => {
            document.getElementById('modal-titulo').textContent = 'Agregar Producto';
            formProducto.reset();
            productoIdInput.value = '';
            // Renderizar checkboxes vac√≠os
            renderizarChecksGrupos(""); 
            abrirModal(modalProducto);
        });

        // Submit del Formulario Producto (MODIFICADO PARA LEER CHECKBOXES)
        formProducto.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Recolectar checkboxes marcados
            const checkboxes = document.querySelectorAll('input[name="grupos_check"]:checked');
            const gruposSeleccionados = Array.from(checkboxes).map(cb => cb.value).join(',');

            const id = productoIdInput.value;
            const data = {
                id: id ? parseInt(id) : null,
                nombre_venta: nombreVentaInput.value,
                precio_base: parseFloat(precioBaseInput.value),
                categoria: categoriaSelect.value,
                grupos_modificadores: gruposSeleccionados, // Usamos la lista generada
                descripcion: descripcionTextarea.value
            };
            
            if (isNaN(data.precio_base) || data.precio_base < 0) return alert('Precio inv√°lido.');
            guardarProducto(data, !!id);
        });

        // Click en tabla (Editar / Eliminar)
        tablaBody.addEventListener('click', (e) => {
            const btn = e.target.closest('.btn');
            if (!btn) return;
            const id = btn.dataset.id;
            
            if (btn.classList.contains('btn-editar-producto')) {
                const producto = productosData.find(p => p.id == id);
                if (producto) {
                    document.getElementById('modal-titulo').textContent = 'Editar Producto';
                    productoIdInput.value = producto.id;
                    nombreVentaInput.value = producto.nombre_venta;
                    precioBaseInput.value = producto.precio_base;
                    categoriaSelect.value = producto.categoria;
                    descripcionTextarea.value = producto.descripcion || '';
                    
                    // Renderizar checkboxes marcando los que ya tiene
                    renderizarChecksGrupos(producto.grupos_modificadores || "");
                    
                    abrirModal(modalProducto);
                }
            } else if (btn.classList.contains('btn-eliminar-producto')) {
                if (confirm("¬øEliminar producto?")) {
                    fetch(`${API_MENU_PRODUCTOS_URL}/${id}`, { method: "DELETE" })
                        .then(() => fetchProductos())
                        .catch(e => alert(e.message));
                }
            }
        });

        // Gesti√≥n de Modificadores (L√≥gica previa mantenida)
        document.getElementById('btn-gestionar-opciones').addEventListener('click', async () => {
            await cargarGruposModificadores();
            abrirModal(modalOpciones);
        });
        
        selectGrupoMod.addEventListener('change', (e) => fetchOpcionesPorGrupo(e.target.value));
        
        btnToggleGroup.addEventListener('click', () => {
            modoNuevoGrupo = !modoNuevoGrupo;
            if (modoNuevoGrupo) {
                selectGrupoMod.style.display = 'none';
                inputGrupoNew.style.display = 'block';
                inputGrupoNew.value = ''; inputGrupoNew.focus();
                btnToggleGroup.textContent = 'Cancelar';
                btnDeleteGroup.style.display = 'none';
                listaOpcionesValores.innerHTML = '<li class="option-item" style="color:gray;">Define nombre y agrega valor.</li>';
            } else {
                selectGrupoMod.style.display = 'block';
                inputGrupoNew.style.display = 'none';
                btnToggleGroup.textContent = '+';
                btnDeleteGroup.style.display = 'block';
                fetchOpcionesPorGrupo(selectGrupoMod.value);
            }
        });

        formAgregarOpcion.addEventListener('submit', async (e) => {
            e.preventDefault();
            const nombreGrupo = modoNuevoGrupo ? inputGrupoNew.value.trim() : selectGrupoMod.value;
            if (!nombreGrupo) return alert("Nombre de grupo requerido.");
            
            try {
                const res = await fetch(API_MENU_OPCIONES_URL, {
                    method: "POST",
                    headers: {"Content-Type":"application/json"},
                    body: JSON.stringify({
                        nombre_opcion: nombreGrupo,
                        valor: document.getElementById('valor-opcion').value,
                        precio_adicional: document.getElementById('precio-adicional').value
                    })
                });
                if (res.ok) {
                    document.getElementById('form-agregar-opcion').reset();
                    if (modoNuevoGrupo) {
                        modoNuevoGrupo = false;
                        selectGrupoMod.style.display = 'block';
                        inputGrupoNew.style.display = 'none';
                        btnToggleGroup.textContent = '+';
                        btnDeleteGroup.style.display = 'block';
                        await cargarGruposModificadores();
                        selectGrupoMod.value = nombreGrupo;
                    }
                    fetchOpcionesPorGrupo(nombreGrupo);
                    alert("Opci√≥n agregada.");
                }
            } catch(e) { alert(e.message); }
        });

        btnDeleteGroup.addEventListener('click', async () => {
            const grp = selectGrupoMod.value;
            if (confirm(`¬øEliminar grupo "${grp}" y todas sus opciones?`)) {
                await fetch(`https://olimpollo-api.onrender.com/api/menu/opciones/grupo/${encodeURIComponent(grp)}`, { method: 'DELETE' });
                cargarGruposModificadores();
            }
        });

        listaOpcionesValores.addEventListener('click', (e) => {
            if (e.target.classList.contains('btn-eliminar-opcion')) {
                if(confirm("¬øEliminar opci√≥n?")) {
                    fetch(`${API_MENU_OPCIONES_URL}/${e.target.dataset.id}`, { method: "DELETE" })
                        .then(() => fetchOpcionesPorGrupo(selectGrupoMod.value));
                }
            }
        });

        document.querySelectorAll('.close').forEach(el => el.addEventListener('click', cerrarModales));
        window.onclick = (e) => { if (e.target.classList.contains('modal')) cerrarModales(); };

        // INICIO
        fetchProductos();
    });
</script>
</body>
</html>
